<!DOCTYPE html>
<html lang="pt-BR" class="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Trilha de Aprendizagem 2026</title>

    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#020617">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" href="icons/favicon.png">
    <link rel="apple-touch-icon" href="icons/favicon.png">

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Outfit', sans-serif;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            overflow-x: hidden;
        }

        /* Liquid Background Animation */
        .liquid-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: #020617;
            overflow: hidden;
        }

        .blob {
            position: absolute;
            background: linear-gradient(135deg, #4F46E5, #9333EA);
            filter: blur(80px);
            opacity: 0.4;
            border-radius: 50%;
            animation: float 10s infinite ease-in-out;
        }

        .blob-1 {
            top: -10%;
            left: -10%;
            width: 50vw;
            height: 50vw;
            animation-delay: 0s;
        }

        .blob-2 {
            bottom: -10%;
            right: -10%;
            width: 60vw;
            height: 60vw;
            background: linear-gradient(135deg, #2563EB, #06B6D4);
            animation-delay: 2s;
        }

        .blob-3 {
            top: 40%;
            left: 40%;
            width: 40vw;
            height: 40vw;
            background: linear-gradient(135deg, #DB2777, #7C3AED);
            animation-delay: 4s;
            opacity: 0.3;
        }

        @keyframes float {
            0% {
                transform: translate(0, 0) scale(1);
            }

            33% {
                transform: translate(30px, -50px) scale(1.1);
            }

            66% {
                transform: translate(-20px, 20px) scale(0.9);
            }

            100% {
                transform: translate(0, 0) scale(1);
            }
        }

        /* Glassmorphism Dark */
        .glass-panel {
            background: rgba(15, 23, 42, 0.4);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
        }

        .day-card {
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .day-card:active {
            transform: scale(0.95);
        }

        .active-day {
            border: 1px solid rgba(129, 140, 248, 0.5);
            background: rgba(79, 70, 229, 0.2);
            box-shadow: 0 0 15px rgba(79, 70, 229, 0.3);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fade-in {
            animation: fadeIn 0.4s ease-out forwards;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.4);
        }

        textarea::placeholder {
            color: rgba(148, 163, 184, 0.5);
        }
    </style>
</head>

<body class="text-slate-200 p-4 md:p-6 pb-24 md:pb-6">

    <!-- Background Blobs -->
    <div class="liquid-bg">
        <div class="blob blob-1"></div>
        <div class="blob blob-2"></div>
        <div class="blob blob-3"></div>
    </div>

    <div class="max-w-6xl mx-auto grid grid-cols-1 lg:grid-cols-12 gap-6 h-full relative z-10">

        <!-- Coluna Esquerda: CalendÃ¡rio -->
        <div class="lg:col-span-8 flex flex-col gap-6 animate-fade-in">

            <header class="glass-panel rounded-3xl p-5 flex flex-col md:flex-row justify-between items-center gap-4">
                <div class="text-center md:text-left">
                    <h1
                        class="text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 drop-shadow-sm font-display tracking-tight">
                        Agenda 2026</h1>
                    <p class="text-xs font-semibold text-blue-300/80 uppercase tracking-[0.2em]">Prof. SÃ©rgio AraÃºjo</p>
                </div>

                <div
                    class="flex items-center gap-4 bg-slate-900/50 rounded-full p-1.5 ring-1 ring-white/10 backdrop-blur-md">
                    <button onclick="mudarMes(-1)"
                        class="p-2.5 hover:bg-white/10 rounded-full transition text-blue-400 active:scale-90">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                            <path d="m15 18-6-6 6-6" />
                        </svg>
                    </button>
                    <span id="mesAnoDisplay" class="font-bold text-lg w-40 text-center text-slate-100">Janeiro
                        2026</span>
                    <button onclick="mudarMes(1)"
                        class="p-2.5 hover:bg-white/10 rounded-full transition text-blue-400 active:scale-90">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                            <path d="m9 18 6-6-6-6" />
                        </svg>
                    </button>
                </div>
            </header>

            <div class="glass-panel rounded-3xl p-4 md:p-6 flex-grow">
                <div class="grid grid-cols-7 mb-4 text-center">
                    <div class="text-[10px] font-bold text-indigo-300/60 uppercase tracking-widest">Dom</div>
                    <div class="text-[10px] font-bold text-indigo-300/60 uppercase tracking-widest">Seg</div>
                    <div class="text-[10px] font-bold text-indigo-300/60 uppercase tracking-widest">Ter</div>
                    <div class="text-[10px] font-bold text-indigo-300/60 uppercase tracking-widest">Qua</div>
                    <div class="text-[10px] font-bold text-indigo-300/60 uppercase tracking-widest">Qui</div>
                    <div class="text-[10px] font-bold text-indigo-300/60 uppercase tracking-widest">Sex</div>
                    <div class="text-[10px] font-bold text-indigo-300/60 uppercase tracking-widest">SÃ¡b</div>
                </div>

                <div id="calendarGrid" class="grid grid-cols-7 gap-2 md:gap-3 h-[400px] md:h-96 auto-rows-fr">
                    <!-- Dias gerados via JS -->
                </div>
            </div>
        </div>

        <!-- Coluna Direita: Detalhes -->
        <div class="lg:col-span-4 flex flex-col gap-6 animate-fade-in" style="animation-delay: 0.1s">

            <div class="glass-panel rounded-3xl p-6 relative overflow-hidden group">
                <div
                    class="absolute top-0 right-0 p-4 opacity-20 text-purple-400 group-hover:opacity-40 transition group-hover:scale-110 duration-500">
                    <svg width="60" height="60" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1"
                        stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10" />
                        <path d="m9 12 2 2 4-4" />
                    </svg>
                </div>
                <h2 class="text-sm font-bold text-purple-300 mb-2 flex items-center gap-2 uppercase tracking-wide">
                    Foco do MÃªs
                </h2>
                <textarea id="metaMes"
                    class="w-full bg-slate-900/40 border border-white/5 rounded-xl p-3 text-sm focus:ring-2 focus:ring-purple-500/50 focus:bg-slate-900/60 transition resize-none h-24 text-slate-200 leading-relaxed outline-none"
                    placeholder="Defina o objetivo pedagÃ³gico principal..."></textarea>
            </div>

            <div class="glass-panel rounded-3xl p-6 flex-grow flex flex-col">
                <div class="flex justify-between items-end mb-4 border-b border-white/5 pb-4">
                    <div>
                        <h2 class="text-lg font-bold text-white">DiÃ¡rio</h2>
                        <p id="dataSelecionada"
                            class="text-xs text-blue-400 font-semibold uppercase tracking-wide mt-1">Selecione um dia
                        </p>
                    </div>
                    <button onclick="salvarEvento()"
                        class="bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-500 hover:to-indigo-500 active:scale-95 text-white text-xs font-bold px-4 py-2.5 rounded-xl transition shadow-lg shadow-blue-500/20 flex items-center gap-2">
                        <span>Salvar</span>
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z" />
                            <polyline points="17 21 17 13 7 13 7 21" />
                            <polyline points="7 3 7 8 15 8" />
                        </svg>
                    </button>
                </div>

                <textarea id="eventoTexto"
                    class="w-full flex-grow bg-slate-900/30 border border-white/5 rounded-xl p-4 text-sm focus:ring-2 focus:ring-blue-500/50 focus:bg-slate-900/50 transition resize-none outline-none text-slate-200"
                    placeholder="Toque em um dia para adicionar notas..."></textarea>

                <div class="mt-4 pt-4">
                    <h3 class="text-[10px] font-bold text-slate-500 uppercase mb-3 flex items-center gap-2">
                        Resumo do MÃªs
                        <span class="h-px bg-white/10 flex-grow"></span>
                    </h3>
                    <div id="listaEventosMes" class="space-y-2 max-h-48 overflow-y-auto pr-2 custom-scrollbar">
                        <!-- Lista gerada via JS -->
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- PWA Install Button -->
    <div id="installContainer"
        class="fixed bottom-6 w-full flex justify-center pointer-events-none opacity-0 translate-y-10 transition-all duration-500 z-50">
        <button id="btnInstall"
            class="pointer-events-auto bg-white/10 backdrop-blur-md border border-white/20 text-white px-6 py-3 rounded-full shadow-2xl flex items-center gap-3 font-semibold text-sm active:scale-95 transition-transform hover:bg-white/20 ring-1 ring-white/30">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M12 2v6" />
                <path d="m9 15 3 3 3-3" />
                <path d="M12 2v6" />
                <rect width="20" height="20" x="2" y="4" rx="2" ry="2" />
                <path d="M12 2v13" />
            </svg>
            Instalar App
        </button>
    </div>

    <script>
        // --- LÃ“GICA DO PWA ---
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(reg => console.log('SW registrado!', reg))
                    .catch(err => console.log('SW falhou:', err));
            });
        }

        let deferredPrompt;
        const installContainer = document.getElementById('installContainer');
        const btnInstall = document.getElementById('btnInstall');

        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            installContainer.classList.remove('opacity-0', 'translate-y-10');
        });

        btnInstall.addEventListener('click', async () => {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                if (outcome === 'accepted') {
                    deferredPrompt = null;
                    installContainer.classList.add('opacity-0', 'translate-y-10');
                }
            }
        });

        // --- LÃ“GICA DA APLICAÃ‡ÃƒO ---
        const meses = ["Janeiro", "Fevereiro", "MarÃ§o", "Abril", "Maio", "Junho", "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"];
        let dataAtual = new Date(2026, 0, 1);
        let diaSelecionado = null;

        const feriados = {
            "1-1": "ConfraternizaÃ§Ã£o Universal", "21-4": "Tiradentes", "1-5": "Dia do Trabalho",
            "7-9": "IndependÃªncia", "12-10": "Nossa Sra. Aparecida", "2-11": "Finados",
            "15-11": "ProclamaÃ§Ã£o RepÃºblica", "25-12": "Natal"
        };

        function init() {
            const lastDate = localStorage.getItem('last-view-date-v2');
            if (lastDate) dataAtual = new Date(lastDate);

            renderizarCalendario();
            carregarMetaMes();
            renderizarListaEventos();

            document.getElementById('metaMes').addEventListener('input', (e) => {
                const chave = `meta-2026-${dataAtual.getMonth()}`;
                localStorage.setItem(chave, e.target.value);
            });
        }

        function renderizarCalendario() {
            localStorage.setItem('last-view-date-v2', dataAtual.toISOString());
            const ano = dataAtual.getFullYear();
            const mes = dataAtual.getMonth();

            document.getElementById('mesAnoDisplay').innerText = `${meses[mes]} ${ano}`;

            carregarMetaMes();
            renderizarListaEventos();

            const primeiroDia = new Date(ano, mes, 1).getDay();
            const totalDias = new Date(ano, mes + 1, 0).getDate();
            const grid = document.getElementById('calendarGrid');
            grid.innerHTML = "";

            for (let i = 0; i < primeiroDia; i++) grid.appendChild(document.createElement('div'));

            for (let dia = 1; dia <= totalDias; dia++) {
                const el = document.createElement('div');
                const chaveData = `${dia}-${mes + 1}-${ano}`;
                const nota = localStorage.getItem(`evento-${chaveData}`);
                const feriado = feriados[`${dia}-${mes + 1}`];

                // Estilo padrÃ£o dia normal Dark Glass
                let css = "day-card bg-white/5 hover:bg-white/10 rounded-xl p-2 cursor-pointer border border-white/5 hover:border-blue-400/50 flex flex-col justify-between h-full min-h-[60px] md:min-h-[80px]";

                if (diaSelecionado && dia === diaSelecionado.getDate() && mes === diaSelecionado.getMonth()) {
                    css += " active-day shadow-lg shadow-indigo-500/20";
                }

                let dot = "";
                if (nota) dot = `<div class="w-2 h-2 rounded-full bg-cyan-400 shadow-[0_0_8px_rgba(34,211,238,0.6)]"></div>`;
                else if (feriado) dot = `<div class="w-1.5 h-1.5 rounded-full bg-red-400/80" title="${feriado}"></div>`;

                el.className = css;
                el.innerHTML = `<span class="font-bold text-sm ${feriado ? 'text-red-400' : 'text-slate-300'}">${dia}</span><div class="flex justify-end p-1">${dot}</div>`;
                el.onclick = () => selecionarDia(dia);
                grid.appendChild(el);
            }
        }

        function selecionarDia(dia) {
            diaSelecionado = new Date(dataAtual.getFullYear(), dataAtual.getMonth(), dia);
            renderizarCalendario();
            const chave = `${dia}-${dataAtual.getMonth() + 1}-${dataAtual.getFullYear()}`;

            document.getElementById('dataSelecionada').innerText = diaSelecionado.toLocaleDateString('pt-BR', { weekday: 'long', day: 'numeric', month: 'long' });
            document.getElementById('eventoTexto').value = localStorage.getItem(`evento-${chave}`) || "";
            document.getElementById('eventoTexto').focus();

            const feriado = feriados[`${dia}-${dataAtual.getMonth() + 1}`];
            document.getElementById('eventoTexto').placeholder = feriado ? `Feriado: ${feriado}` : "Anote aqui...";
        }

        function salvarEvento() {
            if (!diaSelecionado) return alert("Selecione um dia!");
            const chave = `evento-${diaSelecionado.getDate()}-${diaSelecionado.getMonth() + 1}-${diaSelecionado.getFullYear()}`;
            const txt = document.getElementById('eventoTexto').value.trim();
            txt ? localStorage.setItem(chave, txt) : localStorage.removeItem(chave);
            renderizarCalendario();
        }

        function carregarMetaMes() {
            document.getElementById('metaMes').value = localStorage.getItem(`meta-2026-${dataAtual.getMonth()}`) || "";
        }

        function renderizarListaEventos() {
            const lista = document.getElementById('listaEventosMes');
            lista.innerHTML = "";
            const totalDias = new Date(dataAtual.getFullYear(), dataAtual.getMonth() + 1, 0).getDate();
            let html = "";

            for (let d = 1; d <= totalDias; d++) {
                const nota = localStorage.getItem(`evento-${d}-${dataAtual.getMonth() + 1}-${dataAtual.getFullYear()}`);
                if (nota) html += `<div onclick="selecionarDia(${d})" class="text-xs p-3 bg-white/5 rounded-lg border-l-2 border-blue-500 hover:bg-white/10 transition cursor-pointer group"><strong class="block text-blue-300 mb-1 group-hover:text-blue-200">Dia ${d}</strong><span class="text-slate-400 group-hover:text-slate-200">${nota}</span></div>`;

                const feriado = feriados[`${d}-${dataAtual.getMonth() + 1}`];
                if (feriado) html += `<div class="text-xs p-2 bg-red-900/20 rounded-lg text-red-300 border border-red-500/10 opacity-70 select-none">ðŸ“Œ ${d}: ${feriado}</div>`;
            }
            if (!html) html = `<div class="text-xs text-slate-600 text-center py-6 italic">Nada agendado para este mÃªs.</div>`;
            lista.innerHTML = html;
        }

        function mudarMes(dir) {
            dataAtual.setMonth(dataAtual.getMonth() + dir);
            diaSelecionado = null;
            renderizarCalendario();
        }

        init();
    </script>
</body>

</html>