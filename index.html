<!DOCTYPE html>
<html lang="pt-BR" class="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Trilha de Aprendizagem 2026</title>

    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#020617">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" href="icons/favicon.png">
    <link rel="apple-touch-icon" href="icons/favicon.png">

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Outfit', sans-serif;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            overflow-x: hidden;
        }

        /* Liquid Background Animation */
        .liquid-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: #020617;
            overflow: hidden;
        }

        .blob {
            position: absolute;
            background: linear-gradient(135deg, #4F46E5, #9333EA);
            filter: blur(80px);
            opacity: 0.4;
            border-radius: 50%;
            animation: float 10s infinite ease-in-out;
        }

        .blob-1 {
            top: -10%;
            left: -10%;
            width: 50vw;
            height: 50vw;
            animation-delay: 0s;
        }

        .blob-2 {
            bottom: -10%;
            right: -10%;
            width: 60vw;
            height: 60vw;
            background: linear-gradient(135deg, #2563EB, #06B6D4);
            animation-delay: 2s;
        }

        .blob-3 {
            top: 40%;
            left: 40%;
            width: 40vw;
            height: 40vw;
            background: linear-gradient(135deg, #DB2777, #7C3AED);
            animation-delay: 4s;
            opacity: 0.3;
        }

        @keyframes float {
            0% {
                transform: translate(0, 0) scale(1);
            }

            33% {
                transform: translate(30px, -50px) scale(1.1);
            }

            66% {
                transform: translate(-20px, 20px) scale(0.9);
            }

            100% {
                transform: translate(0, 0) scale(1);
            }
        }

        /* Glassmorphism Dark */
        .glass-panel {
            background: rgba(15, 23, 42, 0.4);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
        }

        .day-card {
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .day-card:active {
            transform: scale(0.95);
        }

        .active-day {
            border: 1px solid rgba(129, 140, 248, 0.5);
            background: rgba(79, 70, 229, 0.2);
            box-shadow: 0 0 15px rgba(79, 70, 229, 0.3);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fade-in {
            animation: fadeIn 0.4s ease-out forwards;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.4);
        }

        textarea::placeholder {
            color: rgba(148, 163, 184, 0.5);
        }
    </style>
</head>

<body class="text-slate-200 p-4 md:p-6 pb-24 md:pb-6">

    <!-- Background Blobs -->
    <div class="liquid-bg">
        <div class="blob blob-1"></div>
        <div class="blob blob-2"></div>
        <div class="blob blob-3"></div>
    </div>

    <!-- Hidden File Input for Restore -->
    <input type="file" id="restoreInput" accept=".json" class="hidden" onchange="restaurarBackup(this)">

    <div class="max-w-6xl mx-auto grid grid-cols-1 lg:grid-cols-12 gap-6 h-full relative z-10">

        <!-- Coluna Esquerda: Calendário -->
        <div class="lg:col-span-8 flex flex-col gap-6 animate-fade-in">

            <header class="glass-panel rounded-3xl p-5 flex flex-col md:flex-row justify-between items-center gap-4">
                <div class="text-center md:text-left">
                    <h1 class="text-3xl font-bold text-white drop-shadow-md font-display tracking-tight">Agenda 2026
                    </h1>
                    <p class="text-xs font-semibold text-white/80 uppercase tracking-[0.2em]">Prof. Sérgio Araújo</p>
                </div>

                <div class="flex items-center gap-2">
                    <!-- Controles Mês -->
                    <div
                        class="flex items-center gap-4 bg-slate-900/50 rounded-full p-1.5 ring-1 ring-white/10 backdrop-blur-md mx-auto md:mx-0">
                        <button onclick="mudarMes(-1)"
                            class="p-2.5 hover:bg-white/10 rounded-full transition text-white active:scale-90">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path d="m15 18-6-6 6-6" />
                            </svg>
                        </button>
                        <span id="mesAnoDisplay" class="font-bold text-lg w-40 text-center text-white">Janeiro
                            2026</span>
                        <button onclick="mudarMes(1)"
                            class="p-2.5 hover:bg-white/10 rounded-full transition text-white active:scale-90">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path d="m9 18 6-6-6-6" />
                            </svg>
                        </button>
                    </div>

                    <!-- Botões Backup -->
                    <div class="flex gap-2 ml-2">
                        <button onclick="fazerBackup()" title="Backup (Download)"
                            class="p-3 bg-white/5 hover:bg-white/10 rounded-full backdrop-blur-md ring-1 ring-white/10 transition text-emerald-400">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                                <polyline points="7 10 12 15 17 10" />
                                <line x1="12" x2="12" y1="15" y2="3" />
                            </svg>
                        </button>
                        <button onclick="document.getElementById('restoreInput').click()" title="Restaurar Backup"
                            class="p-3 bg-white/5 hover:bg-white/10 rounded-full backdrop-blur-md ring-1 ring-white/10 transition text-amber-400">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                                <polyline points="17 8 12 3 7 8" />
                                <line x1="12" x2="12" y1="3" y2="15" />
                            </svg>
                        </button>
                    </div>
                </div>
            </header>

            <div class="glass-panel rounded-3xl p-4 md:p-6 flex-grow">
                <div class="grid grid-cols-7 mb-4 text-center">
                    <div class="text-[10px] font-bold text-white/50 uppercase tracking-widest">Dom</div>
                    <div class="text-[10px] font-bold text-white/50 uppercase tracking-widest">Seg</div>
                    <div class="text-[10px] font-bold text-white/50 uppercase tracking-widest">Ter</div>
                    <div class="text-[10px] font-bold text-white/50 uppercase tracking-widest">Qua</div>
                    <div class="text-[10px] font-bold text-white/50 uppercase tracking-widest">Qui</div>
                    <div class="text-[10px] font-bold text-white/50 uppercase tracking-widest">Sex</div>
                    <div class="text-[10px] font-bold text-white/50 uppercase tracking-widest">Sáb</div>
                </div>

                <div id="calendarGrid" class="grid grid-cols-7 gap-2 md:gap-3 h-[400px] md:h-96 auto-rows-fr">
                    <!-- Dias gerados via JS -->
                </div>
            </div>
        </div>

        <!-- Coluna Direita: Detalhes -->
        <div class="lg:col-span-4 flex flex-col gap-6 animate-fade-in" style="animation-delay: 0.1s">

            <div class="glass-panel rounded-3xl p-6 relative overflow-hidden group">
                <div
                    class="absolute top-0 right-0 p-4 opacity-20 text-purple-400 group-hover:opacity-40 transition group-hover:scale-110 duration-500">
                    <svg width="60" height="60" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1"
                        stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10" />
                        <path d="m9 12 2 2 4-4" />
                    </svg>
                </div>
                <h2 class="text-sm font-bold text-purple-300 mb-2 flex items-center gap-2 uppercase tracking-wide">
                    Foco do Mês
                </h2>
                <textarea id="metaMes"
                    class="w-full bg-slate-900/40 border border-white/5 rounded-xl p-3 text-sm focus:ring-2 focus:ring-purple-500/50 focus:bg-slate-900/60 transition resize-none h-20 text-slate-200 leading-relaxed outline-none"
                    placeholder="Defina o objetivo pedagógico principal..."></textarea>
            </div>

            <div class="glass-panel rounded-3xl p-6 flex-grow flex flex-col">
                <div class="flex justify-between items-end mb-4 border-b border-white/5 pb-4">
                    <div>
                        <h2 class="text-lg font-bold text-white">Diário</h2>
                        <div class="flex flex-wrap gap-2 mt-2" id="categorySelector">
                            <!-- Categorias geradas via JS -->
                        </div>
                    </div>
                </div>

                <p id="dataSelecionada" class="text-xs text-blue-400 font-semibold uppercase tracking-wide mb-2">
                    Selecione um dia</p>

                <textarea id="eventoTexto"
                    class="w-full flex-grow bg-slate-900/30 border border-white/5 rounded-xl p-4 text-sm focus:ring-2 focus:ring-blue-500/50 focus:bg-slate-900/50 transition resize-none outline-none text-slate-200"
                    placeholder="Toque em um dia para adicionar notas..."></textarea>

                <div class="flex gap-2 mt-3">
                    <button onclick="salvarEvento()"
                        class="flex-1 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-500 hover:to-indigo-500 active:scale-95 text-white text-xs font-bold px-4 py-3 rounded-xl transition shadow-lg shadow-blue-500/20 flex justify-center items-center gap-2">
                        <span>Salvar</span>
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z" />
                            <polyline points="17 21 17 13 7 13 7 21" />
                            <polyline points="7 3 7 8 15 8" />
                        </svg>
                    </button>

                    <button onclick="exportarICS()" title="Exportar para Calendário do Celular (.ics)"
                        class="bg-white/5 hover:bg-white/10 active:scale-95 text-white p-3 rounded-xl transition border border-white/5">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect width="18" height="18" x="3" y="4" rx="2" ry="2" />
                            <line x1="16" x2="16" y1="2" y2="6" />
                            <line x1="8" x2="8" y1="2" y2="6" />
                            <line x1="3" x2="21" y1="10" y2="10" />
                            <path d="m9 16 2 2 4-4" />
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Resumo Rápido -->
            <div class="glass-panel rounded-3xl p-5 max-h-40 overflow-y-auto custom-scrollbar">
                <h3 class="text-[10px] font-bold text-slate-500 uppercase mb-2 flex items-center gap-2">
                    Resumo do Mês
                </h3>
                <div id="listaEventosMes" class="space-y-1"></div>
            </div>
        </div>

    </div>

    <!-- PWA Install Button -->
    <div id="installContainer"
        class="fixed bottom-6 w-full flex justify-center pointer-events-none opacity-0 translate-y-10 transition-all duration-500 z-50">
        <button id="btnInstall"
            class="pointer-events-auto bg-white/10 backdrop-blur-md border border-white/20 text-white px-6 py-3 rounded-full shadow-2xl flex items-center gap-3 font-semibold text-sm active:scale-95 transition-transform hover:bg-white/20 ring-1 ring-white/30">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M12 2v6" />
                <path d="m9 15 3 3 3-3" />
                <path d="M12 2v6" />
                <rect width="20" height="20" x="2" y="4" rx="2" ry="2" />
                <path d="M12 2v13" />
            </svg>
            Instalar App
        </button>
    </div>

    <script>
        // --- CORES & CATEGORIAS ---
        const CATEGORIAS = {
            'aula': { nome: 'Aula', cor: 'bg-blue-500', sombra: 'shadow-blue-500/50', border: 'border-blue-400' },
            'prova': { nome: 'Prova', cor: 'bg-red-500', sombra: 'shadow-red-500/50', border: 'border-red-400' },
            'reuniao': { nome: 'Reunião', cor: 'bg-purple-500', sombra: 'shadow-purple-500/50', border: 'border-purple-400' },
            'planej': { nome: 'Planej.', cor: 'bg-emerald-500', sombra: 'shadow-emerald-500/50', border: 'border-emerald-400' }
        };
        let catSelecionada = 'aula';

        // --- LÓGICA DO PWA (SW) ---
        if ('serviceWorker' in navigator) navigator.serviceWorker.register('./sw.js');
        let deferredPrompt;
        const installContainer = document.getElementById('installContainer');
        window.addEventListener('beforeinstallprompt', (e) => { e.preventDefault(); deferredPrompt = e; installContainer.classList.remove('opacity-0', 'translate-y-10'); });
        document.getElementById('btnInstall').addEventListener('click', async () => { if (deferredPrompt) { deferredPrompt.prompt(); installContainer.classList.add('opacity-0'); } });

        // --- APP ---
        const meses = ["Janeiro", "Fevereiro", "Março", "Abril", "Maio", "Junho", "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"];
        let dataAtual = new Date(2026, 0, 1);
        let diaSelecionado = null;
        const feriados = { "1-1": "Confraternização Universal", "21-4": "Tiradentes", "1-5": "Dia do Trabalho", "7-9": "Independência", "12-10": "NSra. Aparecida", "2-11": "Finados", "15-11": "Proclamação República", "25-12": "Natal" };

        function init() {
            const lastDate = localStorage.getItem('last-view-date-v3');
            if (lastDate) dataAtual = new Date(lastDate);
            renderizarCategorias();
            renderizarCalendario();
            carregarMetaMes();

            document.getElementById('metaMes').addEventListener('input', (e) => {
                localStorage.setItem(`meta-2026-${dataAtual.getMonth()}`, e.target.value);
            });
        }

        function renderizarCategorias() {
            const container = document.getElementById('categorySelector');
            container.innerHTML = Object.entries(CATEGORIAS).map(([key, info]) => `
                <button onclick="mudarCategoria('${key}')" 
                    class="text-[10px] uppercase font-bold px-2 py-1 rounded-md border transition ${catSelecionada === key ? `bg-white/20 text-white ${info.border}` : 'bg-transparent text-slate-500 border-transparent hover:bg-white/5'}">
                    ${info.nome}
                </button>
            `).join('');
        }

        function mudarCategoria(key) {
            catSelecionada = key;
            renderizarCategorias();
        }

        function renderizarCalendario() {
            localStorage.setItem('last-view-date-v3', dataAtual.toISOString());
            const ano = dataAtual.getFullYear();
            const mes = dataAtual.getMonth();
            document.getElementById('mesAnoDisplay').innerText = `${meses[mes]} ${ano}`;
            carregarMetaMes();
            renderizarListaEventos();

            const primeiroDia = new Date(ano, mes, 1).getDay();
            const totalDias = new Date(ano, mes + 1, 0).getDate();
            const grid = document.getElementById('calendarGrid');
            grid.innerHTML = "";

            for (let i = 0; i < primeiroDia; i++) grid.appendChild(document.createElement('div'));

            for (let dia = 1; dia <= totalDias; dia++) {
                const el = document.createElement('div');
                const chaveData = `${dia}-${mes + 1}-${ano}`;
                const rawData = localStorage.getItem(`evento-${chaveData}`);
                const eventData = rawData ? JSON.parse(rawData) : null;
                const feriado = feriados[`${dia}-${mes + 1}`];

                let css = "day-card bg-white/5 hover:bg-white/10 rounded-xl p-2 cursor-pointer border border-white/5 hover:border-blue-400/50 flex flex-col justify-between h-full min-h-[60px] md:min-h-[80px]";
                if (diaSelecionado && dia === diaSelecionado.getDate() && mes === diaSelecionado.getMonth()) {
                    css += " active-day shadow-lg shadow-indigo-500/20 bg-white/10";
                }

                let dot = "";
                if (eventData) {
                    const cat = CATEGORIAS[eventData.cat] || CATEGORIAS['aula'];
                    dot = `<div class="w-2 h-2 rounded-full ${cat.cor} ${cat.sombra}"></div>`;
                } else if (feriado) {
                    dot = `<div class="w-1.5 h-1.5 rounded-full bg-red-400/80" title="${feriado}"></div>`;
                }

                el.className = css;
                el.innerHTML = `<span class="font-bold text-sm ${feriado ? 'text-red-400' : 'text-slate-300'}">${dia}</span><div class="flex justify-end p-1">${dot}</div>`;
                el.onclick = () => selecionarDia(dia);
                grid.appendChild(el);
            }
        }

        function selecionarDia(dia) {
            diaSelecionado = new Date(dataAtual.getFullYear(), dataAtual.getMonth(), dia);
            renderizarCalendario();
            const chave = `${dia}-${dataAtual.getMonth() + 1}-${dataAtual.getFullYear()}`;

            document.getElementById('dataSelecionada').innerText = diaSelecionado.toLocaleDateString('pt-BR', { weekday: 'long', day: 'numeric', month: 'long' });

            const rawData = localStorage.getItem(`evento-${chave}`);
            if (rawData) {
                try {
                    const data = JSON.parse(rawData);
                    document.getElementById('eventoTexto').value = data.text || "";
                    catSelecionada = data.cat || 'aula';
                } catch {
                    // Legado (string pura)
                    document.getElementById('eventoTexto').value = rawData;
                    catSelecionada = 'aula';
                }
            } else {
                document.getElementById('eventoTexto').value = "";
                catSelecionada = 'aula';
            }
            renderizarCategorias();
            document.getElementById('eventoTexto').focus();

            const feriado = feriados[`${dia}-${dataAtual.getMonth() + 1}`];
            document.getElementById('eventoTexto').placeholder = feriado ? `Feriado: ${feriado}` : "Anote aqui...";
        }

        function salvarEvento() {
            if (!diaSelecionado) return alert("Selecione um dia!");
            const chave = `evento-${diaSelecionado.getDate()}-${diaSelecionado.getMonth() + 1}-${diaSelecionado.getFullYear()}`;
            const txt = document.getElementById('eventoTexto').value.trim();

            if (txt) {
                const data = { text: txt, cat: catSelecionada, ts: Date.now() };
                localStorage.setItem(chave, JSON.stringify(data));
            } else {
                localStorage.removeItem(chave);
            }
            renderizarCalendario();
        }

        function carregarMetaMes() {
            document.getElementById('metaMes').value = localStorage.getItem(`meta-2026-${dataAtual.getMonth()}`) || "";
        }

        function renderizarListaEventos() {
            const lista = document.getElementById('listaEventosMes');
            lista.innerHTML = "";
            const totalDias = new Date(dataAtual.getFullYear(), dataAtual.getMonth() + 1, 0).getDate();
            let html = "";

            for (let d = 1; d <= totalDias; d++) {
                const raw = localStorage.getItem(`evento-${d}-${dataAtual.getMonth() + 1}-${dataAtual.getFullYear()}`);
                if (raw) {
                    let data = { text: raw, cat: 'aula' };
                    try { data = JSON.parse(raw); } catch { }
                    const cat = CATEGORIAS[data.cat] || CATEGORIAS['aula'];

                    html += `<div onclick="selecionarDia(${d})" class="text-xs p-2 bg-white/5 rounded-lg border-l-2 ${cat.border.replace('border', 'border')} hover:bg-white/10 transition cursor-pointer flex gap-2 items-center">
                        <span class="font-bold text-white w-5 text-center">${d}</span>
                        <div class="h-1.5 w-1.5 rounded-full ${cat.cor}"></div>
                        <span class="text-slate-300 truncate">${data.text}</span>
                   </div>`;
                }
            }
            lista.innerHTML = html || `<div class="text-xs text-slate-600 text-center py-2 italic">Nada agendado.</div>`;
        }

        function mudarMes(dir) {
            dataAtual.setMonth(dataAtual.getMonth() + dir);
            diaSelecionado = null;
            renderizarCalendario();
        }

        // --- BACKUP & RESTORE ---
        function fazerBackup() {
            const backup = {};
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key.startsWith('evento-') || key.startsWith('meta-')) {
                    backup[key] = localStorage.getItem(key);
                }
            }
            const blob = new Blob([JSON.stringify(backup)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `backup-agenda-2026-${new Date().toISOString().slice(0, 10)}.json`;
            a.click();
        }

        function restaurarBackup(input) {
            const file = input.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = (e) => {
                const dados = JSON.parse(e.target.result);
                Object.keys(dados).forEach(k => localStorage.setItem(k, dados[k]));
                alert('Agenda restaurada com sucesso!');
                renderizarCalendario();
            };
            reader.readAsText(file);
        }

        // --- EXPORTAR ICS (Calendário) ---
        function exportarICS() {
            if (!diaSelecionado) return alert("Selecione o dia do evento para exportar.");
            const chave = `evento-${diaSelecionado.getDate()}-${diaSelecionado.getMonth() + 1}-${diaSelecionado.getFullYear()}`;
            const raw = localStorage.getItem(chave);
            if (!raw) return alert("Nenhum evento neste dia para exportar.");

            let data;
            try { data = JSON.parse(raw); } catch { data = { text: raw }; }

            // Criar data formatada ICS (YYYYMMDD)
            const ano = diaSelecionado.getFullYear();
            const mes = (diaSelecionado.getMonth() + 1).toString().padStart(2, '0');
            const dia = diaSelecionado.getDate().toString().padStart(2, '0');
            const dateStr = `${ano}${mes}${dia}`;

            const icsContent =
                `BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//Agenda2026//ProfSergio//PT
BEGIN:VEVENT
UID:${Date.now()}@agenda2026
DTSTAMP:${new Date().toISOString().replace(/[-:.]/g, '')}
DTSTART;VALUE=DATE:${dateStr}
SUMMARY:${data.text}
DESCRIPTION:Criado via Agenda 2026 Lite
END:VEVENT
END:VCALENDAR`;

            const blob = new Blob([icsContent], { type: 'text/calendar;charset=utf-8' });
            const link = document.createElement('a');
            link.href = window.URL.createObjectURL(blob);
            link.download = `evento_${dateStr}.ics`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        init();
    </script>
</body>

</html>